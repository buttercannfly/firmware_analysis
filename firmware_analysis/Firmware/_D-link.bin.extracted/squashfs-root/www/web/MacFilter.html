<!DOCTYPE html>
<html id="html">
<head>
<meta name="viewport" content="width=1200">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Pragma" content="No-cache" />
<meta http-equiv="Cache-Control" content="no-cache, must-revalidate" />
<meta http-equiv="Expires" content="-1" />
<link rel=stylesheet type="text/css" href="css/jquery.selectbox.css" media="all" />
<link href="css/stylish-select.css" type="text/css" rel="stylesheet" />
<link href="css/style_page.css" type="text/css" rel="stylesheet" />
<title></title>
<script type="text/javascript" charset="utf-8" src="js/localization/zh-cn.js?V=dir822"></script>
<script type="text/javascript" charset="utf-8" src="js/header.js"></script>
<script type="text/javascript" charset="utf-8" src="js/jquery-1.8.2.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/jquery.selectbox-0.2_new.js"></script>
<script type="text/javascript" charset="utf-8" src="js/SOAP/SOAPAction.js"></script>
<script type="text/javascript" charset="utf-8" src="js/initialJS.js"></script>
<script type="text/javascript" charset="utf-8" src="js/verify/verify.js"></script>
<script type="text/javascript">
//xframeoption
if(top!=self){top.location=self.location;}

var G_List = [];
var G_BfList = [];
var G_List_Length=0;
var MAX_TABLELIST_NUM=8;//表中最大规则数
var HNAP = new HNAP_XML();
var G_OnLoadList="";

var isAddBtnClick=false;//新增规则

function Load_HTML()	
{	
	resetRulePOP();
}
function CreateAccessTable()
{
	if(G_List.length>0)
	{
		document.getElementById("trnull").style.display="none";
	}
	else
	{
		document.getElementById("trnull").style.display="";
	}
	ClearTable("tablelist",3);
	var AccessTableList=[];
	for(var i=0;i<G_List.length;i++)
	{
		AccessTableList[i]=[];
		if(G_List[i][2]=="")
		{
			//AccessTableList[i].push("所有IP");
			AccessTableList[i].push(I18N("j","MacFilter_All_IP"));
		}
		else
		{
			AccessTableList[i].push(G_List[i][2]);
		}
		if(G_List[i][5]=="")
		{
			//AccessTableList[i].push("所有端口");
			AccessTableList[i].push(I18N("j","MacFilter_All_Port"));
		}
		else
		{
			AccessTableList[i].push(G_List[i][5]);
		}
		
		if(G_List[i][3]=="")
		{
			//AccessTableList[i].push("所有IP");
			AccessTableList[i].push(I18N("j","MacFilter_All_IP"));
		}
		else
		{
			AccessTableList[i].push(G_List[i][3]);
		}				
		if(G_List[i][6]=="")
		{
			//AccessTableList[i].push("所有端口");
			AccessTableList[i].push(I18N("j","MacFilter_All_Port"));
		}
		else
		{
			AccessTableList[i].push(G_List[i][6]);
		}			
		AccessTableList[i].push(G_List[i][4]);
		AccessTableList[i].push("<div class='delimg' onclick='deleteData("+i+")'></div>");
	}
	CreateTable("tablelist", AccessTableList);
}

function GetXML()	
{	
	GetResult_1st();
}
function GetResult_1st()
{
	var result_xml = new StringDoc();
	if (result_xml != null)
	{
		result_xml.Set("GetIPv4FirewallSettings");
		HNAP.SetXMLAsync("GetIPv4FirewallSettings", result_xml, function(xml)	{	GetResult_2nd(xml);	});
	}
	else	{	if (DebugMode == 1)	{	alert("[!!GetXML Error!!] Function: GetResult_1st");	}	}
}

function GetResult_2nd(result_xml)
{
	var GetResult_2nd = result_xml.Get("GetIPv4FirewallSettingsResponse/GetIPv4FirewallSettingsResult");
	if (GetResult_2nd == "OK"){
	
		var firewalllistenable = result_xml.Get("GetIPv4FirewallSettingsResponse/firewall_filter_enable");
		var firewalllistmode = result_xml.Get("GetIPv4FirewallSettingsResponse/firewall_filter_mode");
		var firewallinfo= result_xml.Get("GetIPv4FirewallSettingsResponse/firewall_filter_rule");

		
		if(firewalllistenable=="off")
		{
			document.getElementById("ipfilter_enable").checked=false;;
			document.getElementById("ipfilter_statue").className = "checkbox_off";
			document.getElementById("filtercontent").style.display = "none";

			if(firewalllistmode=="deny") {
				document.getElementById("forblack").className = "ic-radio-press";
				document.getElementById("forwhite").className = "ic-radio";
				document.getElementById("ipfilterblack").checked=true;
				document.getElementById("ipfilterwhite").checked=false;
				//alert("deny");
			} else {
				document.getElementById("forblack").className = "ic-radio";
				document.getElementById("forwhite").className = "ic-radio-press";
				document.getElementById("ipfilterblack").checked=false;
				document.getElementById("ipfilterwhite").checked=true;
				//alert("allow");
			}
			
		}
		
		else if(firewalllistmode=="deny")
		{
			document.getElementById("ipfilter_enable").checked=true;
			document.getElementById("ipfilter_statue").className = "checkbox_on";
			document.getElementById("filtercontent").style.display = "";
			document.getElementById("forblack").className = "ic-radio-press";
			document.getElementById("forwhite").className = "ic-radio";
			document.getElementById("ipfilterblack").checked=true;
			document.getElementById("ipfilterwhite").checked=false;
		}
		else if(firewalllistmode=="allow")
		{
			document.getElementById("ipfilter_enable").checked=true;
			document.getElementById("forblack").className = "ic-radio";
			document.getElementById("forwhite").className = "ic-radio-press";
			document.getElementById("ipfilterblack").checked=false;
			document.getElementById("ipfilterwhite").checked=true;
			document.getElementById("ipfilter_statue").className = "checkbox_on";
			document.getElementById("filtercontent").style.display = "";
		}
		G_OnLoadList=firewallinfo;
		var ipfilterlist=[];
		var ipfilterTableList=[];
		var ipfilterlisttem=[];
		if(firewallinfo!="")
		{
			ipfilterlisttem=firewallinfo.split(";");
			
		}
		for(var i=0;i<ipfilterlisttem.length;i++)
		{
			G_List.push(ipfilterlisttem[i].split(","));	
			G_BfList.push(ipfilterlisttem[i].split(","));	
			
		}
		G_List_Length=G_List.length;
		CreateAccessTable();

		document.getElementById("right_content").style.display="";
		document.getElementById("CreateOnloadMessage").style.display="none";		
	} else {

		document.getElementById("right_content").style.display="";
		document.getElementById("CreateOnloadMessage").style.display="none";
		if (DebugMode == 1)	{	
			alert("[!!GetXML Error!!] Function: GetResult_2nd");
		}
	}
}


$(document).ready( function() {
	document.getElementById("right_content").style.display="none";
	document.getElementById("CreateOnloadMessage").style.display="";
	MoreContainMiniheight();
	Load_HTML();
	GetXML();
	checkTimeout();
	document.getElementById("btn_white_empty").value = I18N("j","Commom_Confirm");//确认
	document.getElementById("savebutton").value = I18N("j","Commom_Apply");//确定
	document.getElementById("cancelbutton").value = I18N("j","Commom_Cancel");//取消
	document.getElementById("savebutton5").value = I18N("j","Commom_Save");//保存
});
function IschangeFlag()
{
		if(G_List.length!=0 || G_BfList.length!=0)
		{
			if(G_List!=G_BfList)
			{
				changeFlag=true;
			}
			else
			{
				changeFlag=false;
			}
		}
		
}	
	
function AddCancle()
{
	document.getElementById("createPop").style.display = "none";
	isAddBtnClick=false;
	hideAllErrorInfo();
	resetRulePOP();
}
var edit=-1;

function Add()
{
edit=-1;
isAddBtnClick=true;
document.getElementById("createPop").style.display = "";
document.getElementById("sourceip").value="";
document.getElementById("sourceport").value="";
document.getElementById("select_protype").value="TCP/UDP";
document.getElementById("destip").value="";
document.getElementById("destport").value="";
	var row_num=G_List.length;
	if(row_num >= MAX_TABLELIST_NUM)
	{
		showErr("error_list_num","errorinfo_list_num",I18N("j","Err_MacFilter_TableMaxNum"));
		document.getElementById("savebutton").disabled=true;
	}
}

	
function closeCreateRulePOP()
	{
		var sourceip = document.getElementById("sourceip").value;
		var sourceport=document.getElementById("sourceport").value;
		var select_protype=document.getElementById("select_protype").value;
		var destip=document.getElementById("destip").value;
		var destport=document.getElementById("destport").value;
		
		var subSrcPort=sourceport.split("-");//处理对于100-100端口范围的情况
		var subDstPort=destport.split("-");//处理对于100-100端口范围的情况
		if(subSrcPort.length==2 && (parseInt(subSrcPort[0],10)==parseInt(subSrcPort[1],10)))
		{
			sourceport=subSrcPort[0];
		}
		if(subDstPort.length==2 && (parseInt(subDstPort[0],10)==parseInt(subDstPort[1],10)))
		{
			destport=subDstPort[0];
		}
		G_List.push(["1","",sourceip,destip,select_protype,sourceport,destport]);

		resetRulePOP();
		
		CreateAccessTable();
	}
	
	function resetRulePOP()
	{
		document.getElementById("createPop").style.display = "none";
		document.getElementById("sourceip").value="";
		document.getElementById("sourceport").value="";
		document.getElementById("select_protype").value="TCP/UDP";
		document.getElementById("destip").value="";
		document.getElementById("destport").value="";
		$("#select_protype").selectbox("detach");
		$("#select_protype").selectbox();
		isAddBtnClick=false;	
	}
	
	function  AddList()
	{
	  var result=verifyIpFilterInput();
	  if(result)
	  {
		closeCreateRulePOP();
		IschangeFlag();
	  }
	  
	}
	
	function deleteData(id)
	{
		document.getElementById("savebutton").disabled=false;
		G_List.splice(id,1)
		CreateAccessTable();
		IschangeFlag();
	}
	
	function ChangAccessStatus()
	{
		var a = document.getElementById("ipfilter_enable").checked;

		if(a)
		{
			document.getElementById("ipfilter_statue").className = "checkbox_off";
			document.getElementById("ipfilter_enable").checked=false;
			
			/*
			document.getElementById("forblack").className = "ic-radio-press";
			document.getElementById("forwhite").className = "ic-radio";
			document.getElementById("ipfilterblack").checked=true;
			document.getElementById("ipfilterwhite").checked=false;
			*/
			document.getElementById("filtercontent").style.display = "none";

		}
		else
		{
			document.getElementById("ipfilter_statue").className = "checkbox_on";
			document.getElementById("ipfilter_enable").checked=true;
			/*
			document.getElementById("forblack").className = "ic-radio-press";
			document.getElementById("forwhite").className = "ic-radio";
			document.getElementById("ipfilterblack").checked=true;
			document.getElementById("ipfilterwhite").checked=false;
			*/
			document.getElementById("filtercontent").style.display = "";

		}
	}
	
	function SetXML1() {
		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("waitSettingFinish").style.display = "inline";
		SetResult_2st();
	}
	function SetResult_2st() {
		var result_xml = new StringDoc();
		if (result_xml != null) {
			
			var liststr=G_OnLoadList;

			if(document.getElementById("ipfilter_enable").checked==true)//点击打开时
			{
				result_xml.Set("SetIPv4FirewallSettings/firewall_filter_enable", "on");
				if(document.getElementById("ipfilterblack").checked)
					result_xml.Set("SetIPv4FirewallSettings/firewall_filter_mode", "deny");
				else
					result_xml.Set("SetIPv4FirewallSettings/firewall_filter_mode", "allow");
			}
			else//点击关闭时
			{
				result_xml.Set("SetIPv4FirewallSettings/firewall_filter_enable", "off");
			}
			result_xml.Set("SetIPv4FirewallSettings/firewall_filter_rule", liststr);
	
			HNAP.SetXMLAsync("SetIPv4FirewallSettings", result_xml, function(xml)	{	SetResult_2nd(xml);	});
		} else {	
			if (DebugMode == 1)	{	
				alert("[!!SetXML Error!!] Function: SetResult_2st");	
			}	
		}
	}	
	function ChangIpfilterEnable()
	{
		ChangAccessStatus();
		$.ajax({
			cache: false,
			url: "./js/CheckConnection",
			timeout: 5000,
			type: "GET",
			success: function(data) {
				SetXML1();
			},
			error: function() {
				document.getElementById("DetectRouterConnection").style.display = "inline";
			}
		});		
	
	}
	
	function SaveData()
	{
		$.ajax({
			cache: false,
			url: "./js/CheckConnection",
			timeout: 5000,
			type: "GET",
			success: function(data) {
				SetXML();
			},
			error: function() {
				document.getElementById("DetectRouterConnection").style.display = "inline";
			}
		});	
	}
	
	function SaveDataCheck()
	{
		if(document.getElementById("ipfilterwhite").checked && G_List.length==0)//当为白名单且为空时提示
		{
			document.getElementById("createPop_White_Save_Err").style.display = "inline";
			return false;
		}
		else
		{
			SaveData();
		}
	}
	
	function WhiteEmptyConfirm()
	{
		document.getElementById("createPop_White_Save_Err").style.display = "none";
	}
	
function SetXML() {
	document.getElementById("CreatePopAlertMessage").style.display = "inline";
	document.getElementById("waitSettingFinish").style.display = "inline";
	SetResult_1st();
}
function SetResult_1st() {
	var result_xml = new StringDoc();
	if (result_xml != null) {
		
		var liststr="";
		for(var i=0;i<G_List.length;i++)
		{
			if(i==G_List.length-1)
			{
				liststr+=G_List[i][0]+","+G_List[i][1]+","+G_List[i][2]+","+G_List[i][3]+","+G_List[i][4]+","+G_List[i][5]+","+G_List[i][6];
			}
			else
			{
				liststr+=G_List[i][0]+","+G_List[i][1]+","+G_List[i][2]+","+G_List[i][3]+","+G_List[i][4]+","+G_List[i][5]+","+G_List[i][6]+";";
			}
		
		
		}

		if(document.getElementById("ipfilter_enable").checked==true)
		{
			result_xml.Set("SetIPv4FirewallSettings/firewall_filter_enable", "on");
			if(document.getElementById("ipfilterblack").checked)
			result_xml.Set("SetIPv4FirewallSettings/firewall_filter_mode", "deny");
			else
			result_xml.Set("SetIPv4FirewallSettings/firewall_filter_mode", "allow");
		}
		else
		{
			result_xml.Set("SetIPv4FirewallSettings/firewall_filter_enable", "off");
		}
		result_xml.Set("SetIPv4FirewallSettings/firewall_filter_rule", liststr);

		HNAP.SetXMLAsync("SetIPv4FirewallSettings", result_xml, function(xml)	{	SetResult_2nd(xml);	});
	} else {	
		if (DebugMode == 1)	{	
			alert("[!!SetXML Error!!] Function: SetResult_1st");	
		}	
	}
}

function SetResult_2nd(result_xml) {
	var SetResult_1st = result_xml.Get("SetIPv4FirewallSettingsResponse/SetIPv4FirewallSettingsResult");
	if (SetResult_1st == "OK") {
		setTimeout("waitSettingFinished()", 1000);
	}
	if (SetResult_1st == "ERROR") {
		if (DebugMode == 1) {
		alert("[!!SetXML Error!!] Function: SetResult_2nd");
		}
		window.location.reload();
	}
}
function waitSettingFinished() 
{
	window.location.reload();
}	
function hideAllErrorInfo()
{
	$("#error_1").hide();
	$("#error_2").hide();
	$("#error_3").hide();
	$("#error_4").hide();
	$("#error_list_num").hide();
}
function verifyIpFilterInput()//验证输入有效性
{
	hideAllErrorInfo();
	var srcIpValue=$("#sourceip").val();
	var srcPortValue=$("#sourceport").val();
	var dstIpValue=$("#destip").val();
	var dstPortValue=$("#destport").val();
	var checkprotype=document.getElementById("select_protype").value;

	if(isAddBtnClick)//新增规则
	{
		if(""==srcIpValue && ""==srcPortValue && ""==dstIpValue && ""==dstPortValue)
		{
			showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_AllEmpty"));
			return false;
		}
		if(""!=srcIpValue)
		{	
			if(ERR_INPUT_INVALID == checkInputStr(srcIpValue))//空格检查
			{
				showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrSpace"));
				return false;
			}
			var srcIPresult=checkIpAddr(srcIpValue);
			switch(srcIPresult)//来源IP
			{
				case ERR_IP_NOTNUMBER:
				case ERR_IP_FORMAT:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrFormat"));
					return false;
				case ERR_IP_ALLZERO:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrAllZero"));
					return false;
				case ERR_IP_ALLONE:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrAllOne"));
					return false;
				case ERR_IP_INVALID:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrNet"));
					return false;
				case ERR_IP_FIRSTZERO:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrFirstZero"));
					return false;
				case ERR_IP_LOOP:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrLoop"));
					return false;
				case ERR_IP_GROUP:
					showErr("error_1","errorinfo_1",I18N("j","Err_MacFilter_SrcIpAddrGroup"));
					return false;
				default:
					break;
			}
		}// end of srcIP
		if(""!=srcPortValue)
		{
			if(ERR_INPUT_INVALID == checkInputStr(srcPortValue))//空格检查
			{
				showErr("error_2","errorinfo_2",I18N("j","Err_MacFilter_SrcPortSpace"));
				return false;
			}
			var srcPortResult=verifyPortRange(srcPortValue);
			switch(srcPortResult)
			{
				case ERR_PORT_RANGE:
					showErr("error_2","errorinfo_2",I18N("j","Err_MacFilter_SrcPortRange"));
					return false;
				case ERR_PORT_OUTRANGE:
					showErr("error_2","errorinfo_2",I18N("j","Err_MacFilter_SrcPortOutRange"));
					return false;
				case ERR_PORT_FORMAT:
					showErr("error_2","errorinfo_2",I18N("j","Err_MacFilter_SrcPortFormat"));
					return false;
				default:
					break;
			}
		}// end of srcPort
		
		if(""!=dstIpValue)
		{	
			if(ERR_INPUT_INVALID == checkInputStr(dstIpValue))//空格检查
			{
				showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrSpace"));
				return false;
			}
			var dstIPresult=checkIpAddr(dstIpValue);
			switch(dstIPresult)//目的IP
			{
				case ERR_IP_NOTNUMBER:
				case ERR_IP_FORMAT:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrFormat"));
					return false;
				case ERR_IP_ALLZERO:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrAllZero"));
					return false;
				case ERR_IP_ALLONE:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrAllOne"));
					return false;
				case ERR_IP_INVALID:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrNet"));
					return false;
				case ERR_IP_FIRSTZERO:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrFirstZero"));
					return false;
				case ERR_IP_LOOP:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrLoop"));
					return false;
				case ERR_IP_GROUP:
					showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstIpAddrGroup"));
					return false;
				default:
					break;
			}
			if(dstIpValue==srcIpValue)
			{
				showErr("error_3","errorinfo_3",I18N("j","Err_MacFilter_DstSrcIpSame"));
				return false;
			}
		}// end of dstIP
		if(""!=dstPortValue)
		{
			if(ERR_INPUT_INVALID == checkInputStr(dstPortValue))//空格检查
			{
				showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_DstPortSpace"));
				return false;
			}
			var dstPortResult=verifyPortRange(dstPortValue);
			switch(dstPortResult)
			{
				case ERR_PORT_RANGE:
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_DstPortRange"));
					return false;
				case ERR_PORT_OUTRANGE:
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_DstPortOutRange"));
					return false;
				case ERR_PORT_FORMAT:
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_DstPortFormat"));
					return false;
				default:
					break;
			}
		}// end of dstPort
		var subSrcPort=srcPortValue.split("-");//处理对于100-100端口范围的情况
		var subDstPort=dstPortValue.split("-");//处理对于100-100端口范围的情况
		if(subSrcPort.length==2 && (parseInt(subSrcPort[0],10)==parseInt(subSrcPort[1],10)))
		{
			srcPortValue=subSrcPort[0];
		}
		if(subDstPort.length==2 && (parseInt(subDstPort[0],10)==parseInt(subDstPort[1],10)))
		{
			dstPortValue=subDstPort[0];
		}
		for(var i=0;i<G_List.length;i++)
		{
			//						 2		 3          4             5		   6
			//G_List.push(["1","",sourceip,destip,select_protype,sourceport,destport]);
			if(G_List[i][2]==srcIpValue && G_List[i][3]==dstIpValue && G_List[i][5]==srcPortValue && G_List[i][6]==dstPortValue)
			{
				//if(G_List[i][4]==checkprotype)
				if(checkprotype=="TCP/UDP")
				{
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_RuleSame"));
					return false;
				}
				else if(checkprotype=="TCP" && G_List[i][4]!="UDP")
				{
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_RuleSame"));
					return false;
				}
				else if(checkprotype=="UDP" && G_List[i][4]!="TCP")
				{
					showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_RuleSame"));
					return false;
				}
			}
		}
		/*
		var row_num=G_List.length;
		if(row_num >= MAX_TABLELIST_NUM)
		{
			showErr("error_4","errorinfo_4",I18N("j","Err_MacFilter_TableMaxNum"));
			return false;
		}
		*/
	
	}
	return true;
}

function AccessRadio(tag)
{
		if(tag==0)
		{
			document.getElementById("forblack").className = "ic-radio-press";
			document.getElementById("forwhite").className = "ic-radio";
			document.getElementById("ipfilterblack").checked=true;
			document.getElementById("ipfilterwhite").checked=false;

		}
		else if(tag==1)
		{
			document.getElementById("forblack").className = "ic-radio";
			document.getElementById("forwhite").className = "ic-radio-press";
			document.getElementById("ipfilterblack").checked=false;
			document.getElementById("ipfilterwhite").checked=true;
		}



}
</script>
</head>

<body>
<!-------------------- Logo menu------------------------->
	<div class="wrapper">  
		<div id="header"></div>
		<div class="clearboth" align="center" id="content">
			<div class="morecontent" align="center" id="basiccontent">
		 		<div class="pull-left" id="sub_menu_container"> 
				<script>initialLeftMenu();</script>
				</div>
				<div id="right_content"  class="pull-left" style="display:none; ">
					<table border="0"  class="clearboth tablemoreheader" cellpadding="0" cellspacing="0" align="left">
						<tr>
							<th><script>I18N("h","Commom_IP_Filter");</script><!-- IP过滤 --></th>
							<td class="tdcheckbox">
								 <div id="ipfilter_statue" class="checkbox_on" onclick="ChangIpfilterEnable();">
                       				 <input type="checkbox" id="ipfilter_enable" name="ipfilter_enable" checked>
                      			</div>
							</td>
							</tr>
					</table>
					<div class="clearboth moreline1"></div>
					<div id="filtercontent">
					<div class="description"><span class="inlineblock"><script>I18N("h","MacFilter_Description");</script><!-- IP过滤是用来限制局域网中的某一台，或者某几台设备在某一个时间段内访问互联网。 --></span></div>
					<div style="margin-top:36px;" class="clearboth">
					  <div class="control-label">
						<span>
						  <script>I18N("h","MacFilter_Mode");</script><!-- 过滤模式 -->
						</span>
					  </div>
					  <div class="controls" style="width:auto;">
						<div>
						  <div class="pull-left" style="position:relative; margin-right:14px;">
							<input style="visibility:hidden;" id="ipfilterblack" name="ipfilter_mode" value="deny" checked="checked" type="radio">
							<div style="position:absolute; left:0; top:2px;" class="ic-radio-press" onClick="AccessRadio(0);" id="forblack"></div>
						  </div>
						  <div class="pull-left words2">
							<script>I18N("h","MacFilter_Black_Mode");</script><!-- 黑名单模式（不允许列表中的设备访问） -->
						  </div>
						</div>
						<div class="clearboth" style="padding-top:5px; ">
						  <div class="pull-left" style="position:relative; margin-right:14px;">
							<input style="visibility:hidden;" id="ipfilterwhite" name="ipfilter_mode" value="allow" type="radio">
							<div style="position:absolute; left:0; top:2px;" class="ic-radio" onClick="AccessRadio(1);" id="forwhite"></div>
						  </div>
						  <div class="pull-left words2">
							<script>I18N("h","MacFilter_White_Mode");</script><!-- 白名单模式（只允许列表中的设备访问） -->
						  </div>
						</div>
					  </div>
					</div>							
				<table class="clearboth table_list" id="tablelist" align="left" cellpadding="0" cellspacing="0" style="margin-top:64px; ">
					<tbody>
					<tr class="tableheader">
						<td colspan="7">
							<div style="position:relative;height:100%">
								<span style="text-align:center;"><script>I18N("h","MacFilter_Table");</script><!-- IP过滤列表 --></span>
								<div onClick="Add();" class="addbutton"></div>
							</div>
						</td>
					</tr>
					<tr class="tableheader2">
						<td style="width:160px; "><script>I18N("h","MacFilter_Source_IP");</script><!-- 来源IP --></td>
						<td style="width:100px; "><script>I18N("h","MacFilter_Port_Range");</script><!-- 通信端口范围 --></td>
						<td style="width:160px; "><script>I18N("h","MacFilter_Destination_IP");</script><!-- 目的IP --></td>
						<td style="width:106px; "><script>I18N("h","MacFilter_Port_Range");</script><!-- 通信端口范围 --></td>
						<td style="width:106px; "><script>I18N("h","Commom_Protocol");</script><!-- 通信协议 --></td>
						<td style="width:136px; "><script>I18N("h","Commom_Operation");</script><!-- 操作 --></td>
					</tr>
					<tr id="trnull">
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					</tr>
				
				
				</tbody>
			
			
			</table>					 
					 <table align="left" style="width:100%; margin-top:32px;" class="clearboth">
					 <!-- <tr align="center"><td><input type="button" value="保存" id="savebutton5" class="styled_button_s" onClick="SaveDataCheck();"></td></tr> -->
					 <tr align="center"><td><input type="button" value="" id="savebutton5" class="styled_button_s" onClick="SaveDataCheck();"></td></tr>
					 </table>						
			</div>
				</div><!--end right_content -->
			</div>
	   </div>
 	   <div class="footer_placeholder"></div>  
   </div>
	
	<div style=" display:none;" id="createPop">
	  <div style="width:628px" class="dialogBox2">
		<div class="advance_row">
			<span><script>I18N("h","Commom_Add_Service");</script><!-- 新增服务 --></span>
		</div>
		<div align="center" id="error_list_num" class="errorinfo" style="display:none;">
			<table>
				<tbody>
					<tr>
						<td><div class="ic-sign ic"></div></td>
						<td id="errorinfo_list_num"></td>
					</tr>
				</tbody>
			</table>
		</div>
		<table cellspacing="0" border="0" id="tblWlanAccess" class="clearboth block" style="margin:0 auto; margin-top:32px; width:420px;">
		  <tbody>
			<tr>
			  <th>
			 <script>I18N("h","MacFilter_Src_IP_Address");</script><!-- 来源IP地址 -->
			  </th>
			  <td>
				<input type="text"  maxlength="15" id="sourceip" size="32" name="sourceip" class="styled-text">
			  </td>
			</tr>
			 <tr id="error_1" style="display:none; ">
			  	<td>&nbsp;</td>
			  	<td class="errorinfo">
					<table>
						<tbody>
							<tr>
								<td>
								<div class="ic-sign ic"></div>
							  </td>
							  <td id="errorinfo_1"></td>
							</tr>
						</tbody>
					  </table>
				</td>
			 </tr>			
			 <tr class="space"> </tr>			
			<tr>
			  <th>
			 <script>I18N("h","MacFilter_Port_Range");</script><!-- 通信端口范围 -->
			  </th>
			  <td>					
				<input type="text"  maxlength="11" id="sourceport" size="32" name="destip" class="styled-text">		
			  </td>
			</tr>			
			 <tr id="error_2" style="display:none; ">
			  	<td>&nbsp;</td>
			  	<td class="errorinfo">
					<table>
						<tbody>
							<tr>
								<td>
								<div class="ic-sign ic"></div>
							  </td>
							  <td id="errorinfo_2" style="line-height:20px;"></td>
							</tr>
						</tbody>
					  </table>
				</td>
			 </tr>			
			 <tr class="space"> </tr>			
			<tr>
			  <th>
			 <script>I18N("h","Commom_Protocol_Type");</script><!-- 协议类型 -->
			  </th>
			  <td>
				<select name="select_protype" id="select_protype">
					<option value="TCP">TCP</option>
					<option value="UDP">UDP</option>
					<option value="TCP/UDP">TCP/UDP</option>
				</select>
				</td>
			</tr>			
			 <tr class="space"> </tr>			
			<tr>
			  <th>
			 <script>I18N("h","MacFilter_Dst_IP_Address");</script><!-- 目的IP地址 -->
			  </th>
			  <td>
				<input type="text"  maxlength="15" id="destip" size="32" name="destip" class="styled-text">
			  </td>
			</tr>
			 <tr id="error_3" style="display:none; ">
			  	<td>&nbsp;</td>
			  	<td class="errorinfo">
					<table>
						<tbody>
							<tr>
								<td>
								<div class="ic-sign ic"></div>
							  </td>
							  <td id="errorinfo_3"></td>
							</tr>
						</tbody>
					  </table>
				</td>
			 </tr>							
			 <tr class="space"> </tr>	
			<tr>
			  <th>
			 <script>I18N("h","MacFilter_Port_Range");</script><!-- 通信端口范围 -->
			  </th>
			  <td>
				<input type="text"  maxlength="11" id="destport" size="32" name="destip" class="styled-text">								
			  </td>
			</tr>			
			 <tr id="error_4" style="display:none; ">
			  	<td>&nbsp;</td>
			  	<td class="errorinfo">
					<table>
						<tbody>
							<tr>
								<td>
								<div class="ic-sign ic"></div>
							  </td>
							  <td id="errorinfo_4" style="line-height:20px;"></td>
							</tr>
						</tbody>
					  </table>
				</td>
			 </tr>			
			</tbody>
		</table>
		<div align="center" style="margin-top:32px; ">
		<span>
			<!-- <input type="button" value="取消" id="cancelbutton" class="styled_button_ss" onClick="AddCancle();"> -->
			<input type="button" value="" id="cancelbutton" class="styled_button_ss" onClick="AddCancle();">
		</span>
		<span style="margin-left:20px; ">
			<!-- <input type="button" value="确定" id="savebutton" class="styled_button_ss" onClick="AddList();"> -->
			<input type="button" value="" id="savebutton" class="styled_button_ss" onClick="AddList();">
		</span>
		</div>
	  </div>
	</div>	
	<div style=" display:none;" id="createPop_White_Save_Err" class="createPopRecovery">
		<div class="dialogBoxBackup">
			<div class="advance_rowBackup">
				<span><script>I18N("h","AdvWlanAccess_Tips");</script><!-- 提示 --></span>
			</div>
			<div align="center" style="margin-bottom:34px;margin-top:36px">
				<img src="image/icon_peizhi_sb-.png" class="Backup_img">
				<div class="descriptionBackup" style="margin-bottom:34px;margin-top:26px"><script>I18N("h","MacFilter_White_Empty");</script><!-- 当前白名单为空，请至少添加一条规则！ --></div>
			</div>
			<div class="advance_rowBackup" style="padding-bottom:0px;margin:0"></div>
			<div align="center" style="margin-top:26px;">
				<!-- <input type="button" value="确认" style="width:280px" class="styled_button_ss" onClick="WhiteEmptyConfirm();"> -->
				<input type="button" id="btn_white_empty" value="" style="width:280px" class="styled_button_ss" onClick="WhiteEmptyConfirm();">
			</div>
		</div>
	</div>
	<div id="footer"></div>
	<div id="CreatePopAlertMessage" style=" display:none;"></div>
	<div style=" display:none;" id="DetectRouterConnection"></div>
	<div id="CreateOnloadMessage" style="display:none;"><div class="OnLoadPopRect"><img src="/image/submit.gif" width="58" height="58"></div></div>
</body>
<script type="text/javascript">
Initial();
</script>
</html>
